"use strict";(self.webpackChunkhb=self.webpackChunkhb||[]).push([[69],{7497:(t,e,d)=>{d.r(e),d.d(e,{comp:()=>h,data:()=>l});var a=d(641);const r={},h=(0,d(6262).A)(r,[["render",function(t,e){return(0,a.uX)(),(0,a.CE)("div",null,e[0]||(e[0]=[(0,a.Fv)('<h1 id="文件上传系统" tabindex="-1"><a class="header-anchor" href="#文件上传系统"><span>文件上传系统</span></a></h1><h2 id="_1-服务端后端框架搭建集成" tabindex="-1"><a class="header-anchor" href="#_1-服务端后端框架搭建集成"><span>1. 服务端后端框架搭建集成</span></a></h2><table><thead><tr><th>功能</th><th>说明</th></tr></thead><tbody><tr><td>文件上传流程</td><td>简化并自动化医检大数据平台的样本文件上传流程。通过对指定文件夹的实时监控，系统可自动识别并上传新增文件，并将上传后的文件路径与IRIS系统中对应的样本信息建立绑定关系，最终同步至医检大数据平台，实现文件数据的高效归集与统一管理</td></tr></tbody></table><table><thead><tr><th>组件</th><th>技术选型</th></tr></thead><tbody><tr><td>DI</td><td>AutoFac</td></tr><tr><td>ORM</td><td>SqlSugar</td></tr><tr><td>Cache</td><td>Redis</td></tr><tr><td>Log</td><td>Nlog</td></tr><tr><td>其他</td><td>程序中服务类重新封装，通用组件调整</td></tr></tbody></table><h2 id="_2-账号管理" tabindex="-1"><a class="header-anchor" href="#_2-账号管理"><span>2. 账号管理</span></a></h2><table><thead><tr><th>管理模块</th><th>说明</th></tr></thead><tbody><tr><td>机构管理</td><td>机构信息管理</td></tr><tr><td>部门管理</td><td>部门信息管理</td></tr><tr><td>平台管理</td><td>平台信息管理</td></tr><tr><td>账号管理</td><td>用户账号管理</td></tr></tbody></table><h2 id="_3-权限管理" tabindex="-1"><a class="header-anchor" href="#_3-权限管理"><span>3. 权限管理</span></a></h2><table><thead><tr><th>功能</th><th>实现方式</th></tr></thead><tbody><tr><td>登录端管理</td><td>区分客户端、服务端</td></tr><tr><td>角色权限展示</td><td>通过拦截器、AuthorizationHandler、ApiAuthorizeFilter来判断角色权限，展示不同页面</td></tr></tbody></table><h2 id="_4-基础数据同步" tabindex="-1"><a class="header-anchor" href="#_4-基础数据同步"><span>4. 基础数据同步</span></a></h2><table><thead><tr><th>同步内容</th><th>说明</th></tr></thead><tbody><tr><td>机构同步</td><td>机构信息同步</td></tr><tr><td>科室信息同步</td><td>科室信息同步</td></tr><tr><td>账号同步</td><td>账号信息同步</td></tr></tbody></table><h2 id="_5-客户端相关接口" tabindex="-1"><a class="header-anchor" href="#_5-客户端相关接口"><span>5. 客户端相关接口</span></a></h2><table><thead><tr><th>接口类型</th><th>功能</th></tr></thead><tbody><tr><td>登录接口</td><td>客户端登录认证</td></tr><tr><td>文件上传信息接口</td><td>文件上传信息处理</td></tr><tr><td>客户端健康检查接口</td><td>客户端状态监控</td></tr><tr><td>客户端异常信息接口</td><td>异常信息收集</td></tr></tbody></table><h2 id="_6-ai中台对接" tabindex="-1"><a class="header-anchor" href="#_6-ai中台对接"><span>6. AI中台对接</span></a></h2><table><thead><tr><th>功能</th><th>说明</th></tr></thead><tbody><tr><td>上传信息同步</td><td>包含无关联关系（根据条码号和样本号）</td></tr><tr><td>手动绑定关联关系</td><td>AI中台手动绑定关联关系信息反同</td></tr></tbody></table><h2 id="_7-客户端功能" tabindex="-1"><a class="header-anchor" href="#_7-客户端功能"><span>7. 客户端功能</span></a></h2><h3 id="_7-1-文件监控" tabindex="-1"><a class="header-anchor" href="#_7-1-文件监控"><span>7.1 文件监控</span></a></h3><table><thead><tr><th>监控方式</th><th>说明</th></tr></thead><tbody><tr><td>实时监控</td><td>利用文件系统事件（如inotify/FileSystemWatcher）实现实时监控</td></tr><tr><td>定时扫描</td><td>配合定时扫描确保遗漏文件捕捉</td></tr><tr><td>事件记录</td><td>记录下事件详细信息，在配置的执行时间段异步处理</td></tr></tbody></table><h3 id="_7-2-流程逻辑" tabindex="-1"><a class="header-anchor" href="#_7-2-流程逻辑"><span>7.2 流程逻辑</span></a></h3><h4 id="客户端流程" tabindex="-1"><a class="header-anchor" href="#客户端流程"><span>客户端流程</span></a></h4><ol><li>客户端使用Winform + AntdUI，客户端登录 <img src="https://github.com/user-attachments/assets/0a513214-1734-4736-9ab3-af1edb8a5773" alt="客户端登录"></li></ol><p><strong>目的</strong>：为了解决不同平台下，不同大小组，分别上次文件绑定到不同oss地址（机构下有平台，平台绑定大小组和对应桶） <strong>配置方式</strong>：客户端在上传配置的时候进行配置，例如（勾选大小组后配置大小组下对应的桶信息）</p><h4 id="服务端流程" tabindex="-1"><a class="header-anchor" href="#服务端流程"><span>服务端流程</span></a></h4><blockquote><p>通过定时任务发送http接口到iris接口，完成流程（同时根据接收编号，来判断质控标识，如果真则调用接口使用质控模板发送http请求）</p></blockquote><h2 id="_8-仪器接口" tabindex="-1"><a class="header-anchor" href="#_8-仪器接口"><span>8. 仪器接口</span></a></h2><h3 id="_8-1-仪器通讯" tabindex="-1"><a class="header-anchor" href="#_8-1-仪器通讯"><span>8.1 仪器通讯</span></a></h3><table><thead><tr><th>通讯方式</th><th>说明</th></tr></thead><tbody><tr><td>通讯</td><td>获取设备发过来数据包,解析出的条码号或接收编号等信息字段，通过http接口发送给iris系统（通过base64编码）</td></tr></tbody></table><h3 id="_8-2-串口双向通讯-优利特-us1680" tabindex="-1"><a class="header-anchor" href="#_8-2-串口双向通讯-优利特-us1680"><span>8.2 串口双向通讯（优利特 US1680）</span></a></h3><table><thead><tr><th>步骤</th><th>功能</th></tr></thead><tbody><tr><td>1. 截取标识位</td><td>解析出当前仪器发送的为请求检测信息标识，根据仪器发送过来的信息解析出条码号</td></tr><tr><td>2. 解析仪器数据包</td><td>获取对应的检测项目（可能存在多个检测项目），组装成仪器所需要的数据，发送给仪器，仪器会根据检测项目去执行对应检测项目逻辑，后仪器发送数据包过来，通过标识位解析出当前项目的结果值，生成报文写入到指定txt文件下</td></tr><tr><td>3. Http上传数据</td><td>通过定时任务发送http接口到iris接口，完成流程（同时根据接收编号，来判断质控标识，如果真则调用接口使用质控模板发送http请求）</td></tr></tbody></table><p><strong>交互方式</strong>：网口交互、串口交互、共享文件交互、数据库交互</p><h2 id="_9-工作内容总结" tabindex="-1"><a class="header-anchor" href="#_9-工作内容总结"><span>9. 工作内容总结</span></a></h2><h3 id="_9-1-系统功能" tabindex="-1"><a class="header-anchor" href="#_9-1-系统功能"><span>9.1 系统功能</span></a></h3><table><thead><tr><th>功能</th><th>说明</th></tr></thead><tbody><tr><td>文件上传流程</td><td>简化并自动化医检大数据平台的样本文件上传流程。通过对指定文件夹的实时监控，系统可自动识别并上传新增文件，并将上传后的文件路径与IRIS系统中对应的样本信息建立绑定关系，最终同步至医检大数据平台，实现文件数据的高效归集与统一管理</td></tr></tbody></table><h3 id="_9-2-用户角色" tabindex="-1"><a class="header-anchor" href="#_9-2-用户角色"><span>9.2 用户角色</span></a></h3><table><thead><tr><th>角色</th><th>职责</th></tr></thead><tbody><tr><td>上传人员</td><td>负责日常文件的上传与任务管理</td></tr><tr><td>系统管理员</td><td>负责权限配置、系统维护与异常监控等后台管理工作</td></tr></tbody></table><h3 id="_9-3-技术实现" tabindex="-1"><a class="header-anchor" href="#_9-3-技术实现"><span>9.3 技术实现</span></a></h3><table><thead><tr><th>工作内容</th><th>详细说明</th></tr></thead><tbody><tr><td>后端框架搭建</td><td>1. 封装数据访问层、帮助类、中间件（使用中间件，对返回的数据加密等，错误日志）<br>2. 角色等登录功能（使用 Filter 拦截方法）<br>3. 异常日志功能、AOP 中间件（抽离重复字段查询）</td></tr><tr><td>基础数据接口</td><td>1. 角色权限划分封装 UserContex 上下文帮助类<br>2. 基础信息表数据接口<br>3. 用户登录区分 iris 客户登录，通过 http 接口调用第三方接口，并且获取用户大小组，通过大小组绑定关联到系统中<br>4. 定时任务预警管理通过页面配置时间窗口，转成 cron 表达式通过定时任务，来统计 obs 上传失败率和 iris 关联失败率</td></tr><tr><td>产品协调</td><td>1. 协调产品沟通、技术、原型梳理评审<br>2. 验证可行性确保原型设计在技术层面可实现<br>3. 分析技术难点与潜在风险，明确需求边界，避免原型设计超出实际业务需求<br>4. 确保原型与产品需求文档一致</td></tr><tr><td>客户端监控</td><td>1. 监控文件状态变化修改（FileSystemWatcher）<br>2. 根据用户配置、文件夹路径和正则表达式，解析符合文件要求的列表，添加到任务队列中<br>3. 通过读取文件队列，上传到华为 obs 中，上传完成后发送请求给服务端，服务端接收数据写入数据表（上传完成到数据表中有数据后，使用定时任务，轮询调用 http 请求接口，通过条码号、大小组、检测编号等字段数据发送请求，同时使用 redis 缓存缓存相同 postdata 数据，文件可能会存在重复）<br>4. 关联 iris 文件状态</td></tr><tr><td>客户端文件路径和名称解析</td><td>1. 自动提取文件名或路径关键信息，使用（正则表达式进行提取）</td></tr></tbody></table><h3 id="宏基因系统" tabindex="-1"><a class="header-anchor" href="#宏基因系统"><span>宏基因系统</span></a></h3><table><thead><tr><th>工作内容</th><th>详细说明</th></tr></thead><tbody><tr><td>机器人自动发布报告进程 -&gt; <strong>目的</strong></td><td>为了解决不同平台下,批次检验单是否成功,解决手动排查问题,同时报告监控否长时间未成功原因</td></tr><tr><td>后台管理配置</td><td>通过用户配置检验的平台和大小组,&quot;钉钉webHook信息 &quot;时间间隔, 批次号,通知消息模板,等信息 (例如配置,mNGS批次分析时间达到30分钟, 超时分析通知, 分析完成时,分析异常时)</td></tr><tr><td>客户端pc配置</td><td>客户端通过定时任务,读取共享配置文件下的文件,进行推送信息(通过Http推送到iris,生信).根据后台管理配置,进行推送到不同平台下的钉钉和大小组,达到批次发布报告进程跟踪</td></tr></tbody></table>',38)]))}]]),l=JSON.parse('{"path":"/work/2025/README-Table.html","title":"文件上传系统","lang":"zh-CN","frontmatter":{},"headers":[{"level":2,"title":"1. 服务端后端框架搭建集成","slug":"_1-服务端后端框架搭建集成","link":"#_1-服务端后端框架搭建集成","children":[]},{"level":2,"title":"2. 账号管理","slug":"_2-账号管理","link":"#_2-账号管理","children":[]},{"level":2,"title":"3. 权限管理","slug":"_3-权限管理","link":"#_3-权限管理","children":[]},{"level":2,"title":"4. 基础数据同步","slug":"_4-基础数据同步","link":"#_4-基础数据同步","children":[]},{"level":2,"title":"5. 客户端相关接口","slug":"_5-客户端相关接口","link":"#_5-客户端相关接口","children":[]},{"level":2,"title":"6. AI中台对接","slug":"_6-ai中台对接","link":"#_6-ai中台对接","children":[]},{"level":2,"title":"7. 客户端功能","slug":"_7-客户端功能","link":"#_7-客户端功能","children":[{"level":3,"title":"7.1 文件监控","slug":"_7-1-文件监控","link":"#_7-1-文件监控","children":[]},{"level":3,"title":"7.2 流程逻辑","slug":"_7-2-流程逻辑","link":"#_7-2-流程逻辑","children":[]}]},{"level":2,"title":"8. 仪器接口","slug":"_8-仪器接口","link":"#_8-仪器接口","children":[{"level":3,"title":"8.1 仪器通讯","slug":"_8-1-仪器通讯","link":"#_8-1-仪器通讯","children":[]},{"level":3,"title":"8.2 串口双向通讯（优利特 US1680）","slug":"_8-2-串口双向通讯-优利特-us1680","link":"#_8-2-串口双向通讯-优利特-us1680","children":[]}]},{"level":2,"title":"9. 工作内容总结","slug":"_9-工作内容总结","link":"#_9-工作内容总结","children":[{"level":3,"title":"9.1 系统功能","slug":"_9-1-系统功能","link":"#_9-1-系统功能","children":[]},{"level":3,"title":"9.2 用户角色","slug":"_9-2-用户角色","link":"#_9-2-用户角色","children":[]},{"level":3,"title":"9.3 技术实现","slug":"_9-3-技术实现","link":"#_9-3-技术实现","children":[]},{"level":3,"title":"宏基因系统","slug":"宏基因系统","link":"#宏基因系统","children":[]}]}],"git":{"updatedTime":1753665833000,"contributors":[{"name":"Bo-Hong","username":"Bo-Hong","email":"2764136779@qq.com","commits":1,"url":"https://github.com/Bo-Hong"},{"name":"TuCoke","username":"TuCoke","email":"57646826+TuCoke@users.noreply.github.com","commits":5,"url":"https://github.com/TuCoke"}],"changelog":[{"hash":"a7ea20be1fc7269757be8c5c31ed10f2a77857c5","time":1753665833000,"email":"57646826+TuCoke@users.noreply.github.com","author":"subman","message":"Update README-Table.md"},{"hash":"23ff6365c1498fa31b9471341c220d793f732037","time":1753432067000,"email":"57646826+TuCoke@users.noreply.github.com","author":"subman","message":"Update README-Table.md"},{"hash":"dfe6b074a51feb635b7b6e79290d7b5238b154d4","time":1753431847000,"email":"57646826+TuCoke@users.noreply.github.com","author":"subman","message":"Update README-Table.md"},{"hash":"818db6e2085153962268fdb82e0f3a7be829ef33","time":1753431530000,"email":"57646826+TuCoke@users.noreply.github.com","author":"subman","message":"Update README-Table.md"},{"hash":"94d61a25d849a7eef005b8f717b528f5971feaf2","time":1753431333000,"email":"57646826+TuCoke@users.noreply.github.com","author":"subman","message":"Update README-Table.md"},{"hash":"b684f88b6fd6bee95bc8582623fa5ba66a9a6a44","time":1753430525000,"email":"2764136779@qq.com","author":"Bo-Hong","message":"table格式的输出"}]},"filePathRelative":"work/2025/README-Table.md"}')}}]);